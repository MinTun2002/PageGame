<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Comment - 2048</title>
</head>
<body>
    <h1>Comment - 2048</h1>

    <form id="comment-form">
        <textarea id="comment-input" rows="4" cols="50" placeholder="Enter your comment"></textarea><br>
        <button type="submit">Submit</button>
    </form>

    <h2>Comments</h2>
    <ul id="comments-list"></ul>

    <script>
        // Gửi bình luận
        document.getElementById('comment-form').addEventListener('submit', async (event) => {
            event.preventDefault();

            const content = document.getElementById('comment-input').value;
            const data = { content };

            try {
                await fetch('/api/comments', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                // Xóa nội dung trong ô input sau khi gửi bình luận thành công
                document.getElementById('comment-input').value = '';

                // Tải lại danh sách bình luận để hiển thị bình luận mới
                loadComments();
            } catch (error) {
                console.error('Error:', error);
            }
        });

        // Tải danh sách bình luận
        async function loadComments() {
            try {
                const response = await fetch('/api/comments/2048');
                const comments = await response.json();

                // Hiển thị danh sách bình luận
                const commentsList = document.getElementById('comments-list');
                commentsList.innerHTML = '';

                comments.forEach(comment => {
                    const commentItem = document.createElement('li');
                    commentItem.textContent = comment.content;
                    commentsList.appendChild(commentItem);
                });
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // Gọi hàm loadComments khi trang web được tải lần đầu
        loadComments();
    </script>
</body>
</html>
